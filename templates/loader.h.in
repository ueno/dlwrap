/*
 * Copying and distribution of this file, with or without modification,
 * are permitted in any medium without royalty provided the copyright
 * notice and this notice are preserved.  This file is offered as-is,
 * without any warranty.
 */

#ifndef @LOADER_H_GUARD@
#define @LOADER_H_GUARD@

@INCLUDES@

#if defined(@ENABLE_DLOPEN@) && @ENABLE_DLOPEN@

#define FUNC(ret, name, args, cargs)		\
  ret @FUNCTION_PREFIX@_##name args;
#define VOID_FUNC FUNC
#include "@FUNCTIONS_H@"
#undef VOID_FUNC
#undef FUNC

#define @WRAPPER@(name) @FUNCTION_PREFIX@_##name

#else

#define @WRAPPER@(name) name

#endif /* @ENABLE_DLOPEN@ */

/* Ensure SONAME to be loaded and all the necessary symbols are resolved.
 * Returns 0 on success; negative error code otherwise.
 *
 * Note that this function is NOT thread-safe; when calling it from
 * multi-threaded programs, protect it with a locking mechanism.
 */
int @LIBRARY_PREFIX@_ensure_library (const char *soname);

#endif /* @LOADER_H_GUARD@ */
